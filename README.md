# Azure-API-App
This sample code is an Azure API App. 

It's based on Baidu API store(http://apistore.baidu.com). Baidu API store provides a variety of APIs, like weather query API, exchange rate query API, map API, social share API and so on. 

This sample code implements the REST API of query of weather, exchange rate, air quality index, mobile phone location and information of identity card, through implementing Azure API App, and calling the related Baidu public, free and anonymous REST APIs.

You can publish this sample to an Azure API App, and get the below REST APIs:

1. Query for air condition index, the input parameter is city name(only cities in China)
       GET: .../api/AQI/GetAQI
2. Query for current exchange rate, the input parameter is source currency, destination currency and currency amount
       GET: .../api/Currency/GetCurrency
3. Query for identity card information, the input parameter is ID (only in China)
       GET: .../api/IDInfo/GetIDInfo
4. Query for location and carrier of mobile phone, the input parameter is mobile phone number (only in China)
       GET: .../api/MobilePhone/GetMobilePhone
5. Query for weather, the input parameter is city name or city pinyin or city code (only in China)
       GET: .../api/Weather/GetWeatherInfo
6. Query for city information like city code, zip code, the input parameter is city name (only in China)
       GET: .../api/Weather/GetCityInfo

If you have a console or mobile application or website, you can download the SDK automatically generated by this API App from Visual Studio, install it in the application and call the functions in it to implement query.
    
You can also use it in a logic app to implement some blocks in the workflow.

# Azure-API-APP中文解释

该Sample Code基于百度API商店的即用API实现的Azure API App，包括中国国内城市查询、城市空气质量查询、移动电话号码归属地查询、身份证信息查询和汇率查询等功能的REST API。该Sample Code采用ASP.NET MVC实现。

####代码使用方法：
#####1.创建Azure API App服务

在Azure管理门户(目前Azure API App只在Global Azure上可用)中创建一个Azure API App服务，输入API App的名称、host plan、Resource Group以及创建位置等信息，点击创建。

![alt text](https://github.com/THULiusj/Azure-API-App-BaiduAPIStoreConnector/raw/master/Images/1.jpg "图1")

#####2.下载和运行源代码
从Github下载Sample Code，从Visual Studio打开。直接在本地运行，首页没有内容。打开Swagger UI页面(http://localhost:43346/swagger), 可以直接测试所有实现的REST API。

![alt text](https://github.com/THULiusj/Azure-API-App-BaiduAPIStoreConnector/raw/master/Images/2.jpg "图2")

#####3.API解释

* **AQI**用来查询空气质量，传入参数为中国城市汉字名
* **Currency**用来查询货币汇率，传入参数为货币符号英文缩写和转换钱数
* **IDInfo**用来查询中国身份证信息，传入参数为身份证号
* **MobilePhone**用来查询中国国内移动号码信息，传入参数为移动号码
* **Weather**用来查询中国国内天气，传入参数为城市汉字名、城市拼音和城市码三选一。

#####4.发布到Azure，生成Connector
首先在Solution目录中右键工程，点击发布，选择发布目标为Microsoft Azure API Apps。如果Visual Studio已经登录了Azure的订阅，可以直接选择已经创建好的Azure API App。

![alt text](https://github.com/THULiusj/Azure-API-App-BaiduAPIStoreConnector/raw/master/Images/3.jpg "图3")

选择已有的Azure API App后可以查看该服务的详细信息，验证连通性，点击发布将该code发布到Azure上去。

![alt text](https://github.com/THULiusj/Azure-API-App-BaiduAPIStoreConnector/raw/master/Images/4.jpg "图4")

#####5.设置访问权限
在Azure API App页面打开**Setting -> Application Settings -> Access Level**，选择公开访问权限，这样可以直接访问该API，其他的两种分别是认证访问权限和内部服务访问权限。

![alt text](https://github.com/THULiusj/Azure-API-App-BaiduAPIStoreConnector/raw/master/Images/5.jpg "图5")

#####6.调用该Connector
1) 通过REST API直接调用

在Azure API App页面可以找到URL，匿名访问模式下，可以直接调用。

2) 通过客户端调用

创建一个Console应用，右键点击工程，选择**Add -> Azure API App Client**。

![alt text](https://github.com/THULiusj/Azure-API-App-BaiduAPIStoreConnector/raw/master/Images/6.jpg "图6")

可以在线选择创建的API App服务，或者从Portal上下载Swagger文件，从本地加载。点击OK后Visual Studio会自动下载和安装所需要的索引和库。

![alt text](https://github.com/THULiusj/Azure-API-App-BaiduAPIStoreConnector/raw/master/Images/7.jpg "图7")

创建成功后，可以在主函数中通过SDK调用。

    static void Main(string[] args)
    {
            var client = new BaiduAPIStoreTestConnector();
            var PM25result = client.AQI.GetAQI("北京");
            Console.WriteLine(PM25result.Aqi);
            Console.ReadLine();
    }

3) 通过Azure Logic App调用

Logic App可以调用与它同一Resource Group中的API App作为Trigger或者Action，实现工作流。

![alt text](https://github.com/THULiusj/Azure-API-App-BaiduAPIStoreConnector/raw/master/Images/8.jpg "图8")



